{"version":3,"file":"favicon.mjs","sources":["../../src/middlewares/favicon.ts"],"sourcesContent":["import { existsSync } from 'fs';\r\nimport { resolve } from 'path';\r\nimport koaFavicon from 'koa-favicon';\r\nimport type { Core } from '@strapi/types';\r\n\r\nexport type Config = NonNullable<Parameters<typeof koaFavicon>[1]>;\r\n\r\nconst defaults = {\r\n  path: 'favicon.png',\r\n  maxAge: 86400000,\r\n};\r\n\r\nexport const favicon: Core.MiddlewareFactory<Config> = (config, { strapi }) => {\r\n  const { maxAge, path: faviconDefaultPath } = { ...defaults, ...config };\r\n  const { root: appRoot } = strapi.dirs.app;\r\n  let faviconPath = faviconDefaultPath;\r\n\r\n  /** TODO (v5): Updating the favicon to use a png caused\r\n   *  https://github.com/strapi/strapi/issues/14693\r\n   *\r\n   *  This check ensures backwards compatibility until\r\n   *  the next major version\r\n   */\r\n  if (!existsSync(resolve(appRoot, faviconPath))) {\r\n    faviconPath = 'favicon.ico';\r\n  }\r\n\r\n  return koaFavicon(resolve(appRoot, faviconPath), { maxAge });\r\n};\r\n"],"names":[],"mappings":";;;AAOA,MAAM,WAAW;AAAA,EACf,MAAM;AAAA,EACN,QAAQ;AACV;AAEO,MAAM,UAA0C,CAAC,QAAQ,EAAE,aAAa;AACvE,QAAA,EAAE,QAAQ,MAAM,uBAAuB,EAAE,GAAG,UAAU,GAAG,OAAO;AACtE,QAAM,EAAE,MAAM,QAAQ,IAAI,OAAO,KAAK;AACtC,MAAI,cAAc;AAQlB,MAAI,CAAC,WAAW,QAAQ,SAAS,WAAW,CAAC,GAAG;AAChC,kBAAA;AAAA,EAAA;AAGhB,SAAO,WAAW,QAAQ,SAAS,WAAW,GAAG,EAAE,QAAQ;AAC7D;"}