{"version":3,"file":"AuthResponse-DREC3O4E.js","sources":["../../ee/admin/src/utils/cookies.ts","../../ee/admin/src/pages/AuthResponse.tsx"],"sourcesContent":["export const getCookieValue = (name: string) => {\r\n  let result = null;\r\n  const cookieArray = document.cookie.split(';');\r\n  cookieArray.forEach((cookie) => {\r\n    const [key, value] = cookie.split('=').map((item) => item.trim());\r\n    if (key.trim() === name) {\r\n      result = decodeURIComponent(value);\r\n    }\r\n  });\r\n  return result;\r\n};\r\n\r\nexport const deleteCookie = (name: string) => {\r\n  // Set the cookie to expire in the past\r\n  document.cookie = name + '=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';\r\n};\r\n","import * as React from 'react';\r\n\r\nimport { useIntl } from 'react-intl';\r\nimport { useNavigate, useMatch } from 'react-router-dom';\r\n\r\nimport { Page } from '../../../../admin/src/components/PageHelpers';\r\nimport { useTypedDispatch } from '../../../../admin/src/core/store/hooks';\r\nimport { login } from '../../../../admin/src/reducer';\r\nimport { getCookieValue, deleteCookie } from '../utils/cookies';\r\n\r\nconst AuthResponse = () => {\r\n  const match = useMatch('/auth/login/:authResponse');\r\n  const { formatMessage } = useIntl();\r\n  const navigate = useNavigate();\r\n  const dispatch = useTypedDispatch();\r\n\r\n  const redirectToOops = React.useCallback(() => {\r\n    navigate({\r\n      pathname: '/auth/oops',\r\n      search: `?info=${encodeURIComponent(\r\n        formatMessage({\r\n          id: 'Auth.form.button.login.providers.error',\r\n          defaultMessage: 'We cannot connect you through the selected provider.',\r\n        })\r\n      )}`,\r\n    });\r\n  }, [navigate, formatMessage]);\r\n\r\n  React.useEffect(() => {\r\n    if (match?.params.authResponse === 'error') {\r\n      redirectToOops();\r\n    }\r\n\r\n    if (match?.params.authResponse === 'success') {\r\n      const jwtToken = getCookieValue('jwtToken');\r\n\r\n      if (jwtToken) {\r\n        dispatch(\r\n          login({\r\n            token: jwtToken,\r\n          })\r\n        );\r\n\r\n        deleteCookie('jwtToken');\r\n\r\n        navigate('/auth/login');\r\n      } else {\r\n        redirectToOops();\r\n      }\r\n    }\r\n  }, [dispatch, match, redirectToOops, navigate]);\r\n\r\n  return <Page.Loading />;\r\n};\r\n\r\nexport { AuthResponse };\r\n"],"names":["useMatch","useIntl","useNavigate","useTypedDispatch","React","login","jsx","Page"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAa,MAAA,cAAA,GAAiB,CAAC,IAAiB,KAAA;AAC9C,EAAA,IAAI,MAAS,GAAA,IAAA;AACb,EAAA,MAAM,WAAc,GAAA,QAAA,CAAS,MAAO,CAAA,KAAA,CAAM,GAAG,CAAA;AAC7C,EAAY,WAAA,CAAA,OAAA,CAAQ,CAAC,MAAW,KAAA;AAC9B,IAAA,MAAM,CAAC,GAAA,EAAK,KAAK,CAAA,GAAI,MAAO,CAAA,KAAA,CAAM,GAAG,CAAA,CAAE,GAAI,CAAA,CAAC,IAAS,KAAA,IAAA,CAAK,MAAM,CAAA;AAChE,IAAI,IAAA,GAAA,CAAI,IAAK,EAAA,KAAM,IAAM,EAAA;AACvB,MAAA,MAAA,GAAS,mBAAmB,KAAK,CAAA;AAAA;AACnC,GACD,CAAA;AACD,EAAO,OAAA,MAAA;AACT,CAAA;AAEa,MAAA,YAAA,GAAe,CAAC,IAAiB,KAAA;AAE5C,EAAA,QAAA,CAAS,SAAS,IAAO,GAAA,mDAAA;AAC3B,CAAA;;ACLA,MAAM,eAAe,MAAM;AACzB,EAAM,MAAA,KAAA,GAAQA,wBAAS,2BAA2B,CAAA;AAClD,EAAM,MAAA,EAAE,aAAc,EAAA,GAAIC,iBAAQ,EAAA;AAClC,EAAA,MAAM,WAAWC,0BAAY,EAAA;AAC7B,EAAA,MAAM,WAAWC,sBAAiB,EAAA;AAElC,EAAM,MAAA,cAAA,GAAiBC,gBAAM,CAAA,WAAA,CAAY,MAAM;AAC7C,IAAS,QAAA,CAAA;AAAA,MACP,QAAU,EAAA,YAAA;AAAA,MACV,QAAQ,CAAS,MAAA,EAAA,kBAAA;AAAA,QACf,aAAc,CAAA;AAAA,UACZ,EAAI,EAAA,wCAAA;AAAA,UACJ,cAAgB,EAAA;AAAA,SACjB;AAAA,OACF,CAAA;AAAA,KACF,CAAA;AAAA,GACA,EAAA,CAAC,QAAU,EAAA,aAAa,CAAC,CAAA;AAE5B,EAAAA,gBAAA,CAAM,UAAU,MAAM;AACpB,IAAI,IAAA,KAAA,EAAO,MAAO,CAAA,YAAA,KAAiB,OAAS,EAAA;AAC1C,MAAe,cAAA,EAAA;AAAA;AAGjB,IAAI,IAAA,KAAA,EAAO,MAAO,CAAA,YAAA,KAAiB,SAAW,EAAA;AAC5C,MAAM,MAAA,QAAA,GAAW,eAAe,UAAU,CAAA;AAE1C,MAAA,IAAI,QAAU,EAAA;AACZ,QAAA,QAAA;AAAA,UACEC,WAAM,CAAA;AAAA,YACJ,KAAO,EAAA;AAAA,WACR;AAAA,SACH;AAEA,QAAA,YAAA,CAAa,UAAU,CAAA;AAEvB,QAAA,QAAA,CAAS,aAAa,CAAA;AAAA,OACjB,MAAA;AACL,QAAe,cAAA,EAAA;AAAA;AACjB;AACF,KACC,CAAC,QAAA,EAAU,KAAO,EAAA,cAAA,EAAgB,QAAQ,CAAC,CAAA;AAE9C,EAAO,uBAAAC,cAAA,CAACC,UAAK,CAAA,OAAA,EAAL,EAAa,CAAA;AACvB;;;;"}