{"version":3,"file":"logger.mjs","sources":["../../../src/cli/utils/logger.ts"],"sourcesContent":["import chalk from 'chalk';\r\nimport ora, { Ora } from 'ora';\r\nimport * as cliProgress from 'cli-progress';\r\n\r\nexport interface LoggerOptions {\r\n  silent?: boolean;\r\n  debug?: boolean;\r\n  timestamp?: boolean;\r\n}\r\n\r\nexport interface Logger {\r\n  warnings: number;\r\n  errors: number;\r\n  debug: (...args: unknown[]) => void;\r\n  info: (...args: unknown[]) => void;\r\n  success: (...args: unknown[]) => void;\r\n  warn: (...args: unknown[]) => void;\r\n  error: (...args: unknown[]) => void;\r\n  log: (...args: unknown[]) => void;\r\n  spinner: (text: string) => Pick<ora.Ora, 'succeed' | 'fail' | 'start' | 'text' | 'isSpinning'>;\r\n  progressBar: (\r\n    totalSize: number,\r\n    text: string\r\n  ) => Pick<cliProgress.SingleBar, 'start' | 'stop' | 'update'>;\r\n}\r\n\r\nconst silentSpinner = {\r\n  succeed() {\r\n    return this;\r\n  },\r\n  fail() {\r\n    return this;\r\n  },\r\n  start() {\r\n    return this;\r\n  },\r\n  text: '',\r\n  isSpinning: false,\r\n} as Ora;\r\n\r\nconst silentProgressBar = {\r\n  start() {\r\n    return this;\r\n  },\r\n  stop() {\r\n    return this;\r\n  },\r\n  update() {\r\n    return this;\r\n  },\r\n} as unknown as cliProgress.SingleBar;\r\n\r\nconst createLogger = (options: LoggerOptions = {}): Logger => {\r\n  const { silent = false, debug = false, timestamp = true } = options;\r\n\r\n  const state = { errors: 0, warning: 0 };\r\n\r\n  return {\r\n    get warnings() {\r\n      return state.warning;\r\n    },\r\n\r\n    get errors() {\r\n      return state.errors;\r\n    },\r\n\r\n    debug(...args) {\r\n      if (silent || !debug) {\r\n        return;\r\n      }\r\n\r\n      console.log(\r\n        chalk.cyan(`[DEBUG]${timestamp ? `\\t[${new Date().toISOString()}]` : ''}`),\r\n        ...args\r\n      );\r\n    },\r\n\r\n    info(...args) {\r\n      if (silent) {\r\n        return;\r\n      }\r\n\r\n      console.info(\r\n        chalk.blue(`[INFO]${timestamp ? `\\t[${new Date().toISOString()}]` : ''}`),\r\n        ...args\r\n      );\r\n    },\r\n\r\n    log(...args) {\r\n      if (silent) {\r\n        return;\r\n      }\r\n\r\n      console.info(chalk.blue(`${timestamp ? `\\t[${new Date().toISOString()}]` : ''}`), ...args);\r\n    },\r\n\r\n    success(...args) {\r\n      if (silent) {\r\n        return;\r\n      }\r\n\r\n      console.info(\r\n        chalk.green(`[SUCCESS]${timestamp ? `\\t[${new Date().toISOString()}]` : ''}`),\r\n        ...args\r\n      );\r\n    },\r\n\r\n    warn(...args) {\r\n      state.warning += 1;\r\n\r\n      if (silent) {\r\n        return;\r\n      }\r\n\r\n      console.warn(\r\n        chalk.yellow(`[WARN]${timestamp ? `\\t[${new Date().toISOString()}]` : ''}`),\r\n        ...args\r\n      );\r\n    },\r\n\r\n    error(...args) {\r\n      state.errors += 1;\r\n\r\n      if (silent) {\r\n        return;\r\n      }\r\n\r\n      console.error(\r\n        chalk.red(`[ERROR]${timestamp ? `\\t[${new Date().toISOString()}]` : ''}`),\r\n        ...args\r\n      );\r\n    },\r\n\r\n    spinner(text: string) {\r\n      if (silent) {\r\n        return silentSpinner;\r\n      }\r\n\r\n      return ora(text);\r\n    },\r\n\r\n    progressBar(totalSize: number, text: string) {\r\n      if (silent) {\r\n        return silentProgressBar;\r\n      }\r\n\r\n      const progressBar = new cliProgress.SingleBar({\r\n        format: `${text ? `${text} |` : ''}${chalk.green('{bar}')}| {percentage}%`,\r\n        barCompleteChar: '\\u2588',\r\n        barIncompleteChar: '\\u2591',\r\n        hideCursor: true,\r\n        forceRedraw: true,\r\n      });\r\n\r\n      progressBar.start(totalSize, 0);\r\n\r\n      return progressBar;\r\n    },\r\n  };\r\n};\r\n\r\nexport { createLogger };\r\n"],"names":[],"mappings":";;;AA0BA,MAAM,gBAAgB;AAAA,EACpB,UAAU;AACD,WAAA;AAAA,EACT;AAAA,EACA,OAAO;AACE,WAAA;AAAA,EACT;AAAA,EACA,QAAQ;AACC,WAAA;AAAA,EACT;AAAA,EACA,MAAM;AAAA,EACN,YAAY;AACd;AAEA,MAAM,oBAAoB;AAAA,EACxB,QAAQ;AACC,WAAA;AAAA,EACT;AAAA,EACA,OAAO;AACE,WAAA;AAAA,EACT;AAAA,EACA,SAAS;AACA,WAAA;AAAA,EAAA;AAEX;AAEA,MAAM,eAAe,CAAC,UAAyB,OAAe;AAC5D,QAAM,EAAE,SAAS,OAAO,QAAQ,OAAO,YAAY,SAAS;AAE5D,QAAM,QAAQ,EAAE,QAAQ,GAAG,SAAS,EAAE;AAE/B,SAAA;AAAA,IACL,IAAI,WAAW;AACb,aAAO,MAAM;AAAA,IACf;AAAA,IAEA,IAAI,SAAS;AACX,aAAO,MAAM;AAAA,IACf;AAAA,IAEA,SAAS,MAAM;AACT,UAAA,UAAU,CAAC,OAAO;AACpB;AAAA,MAAA;AAGM,cAAA;AAAA,QACN,MAAM,KAAK,UAAU,YAAY,MAAM,oBAAI,KAAK,GAAE,YAAa,CAAA,MAAM,EAAE,EAAE;AAAA,QACzE,GAAG;AAAA,MACL;AAAA,IACF;AAAA,IAEA,QAAQ,MAAM;AACZ,UAAI,QAAQ;AACV;AAAA,MAAA;AAGM,cAAA;AAAA,QACN,MAAM,KAAK,SAAS,YAAY,MAAM,oBAAI,KAAK,GAAE,YAAa,CAAA,MAAM,EAAE,EAAE;AAAA,QACxE,GAAG;AAAA,MACL;AAAA,IACF;AAAA,IAEA,OAAO,MAAM;AACX,UAAI,QAAQ;AACV;AAAA,MAAA;AAGF,cAAQ,KAAK,MAAM,KAAK,GAAG,YAAY,MAAU,oBAAA,KAAO,GAAA,YAAA,CAAa,MAAM,EAAE,EAAE,GAAG,GAAG,IAAI;AAAA,IAC3F;AAAA,IAEA,WAAW,MAAM;AACf,UAAI,QAAQ;AACV;AAAA,MAAA;AAGM,cAAA;AAAA,QACN,MAAM,MAAM,YAAY,YAAY,MAAM,oBAAI,KAAK,GAAE,YAAa,CAAA,MAAM,EAAE,EAAE;AAAA,QAC5E,GAAG;AAAA,MACL;AAAA,IACF;AAAA,IAEA,QAAQ,MAAM;AACZ,YAAM,WAAW;AAEjB,UAAI,QAAQ;AACV;AAAA,MAAA;AAGM,cAAA;AAAA,QACN,MAAM,OAAO,SAAS,YAAY,MAAM,oBAAI,KAAK,GAAE,YAAa,CAAA,MAAM,EAAE,EAAE;AAAA,QAC1E,GAAG;AAAA,MACL;AAAA,IACF;AAAA,IAEA,SAAS,MAAM;AACb,YAAM,UAAU;AAEhB,UAAI,QAAQ;AACV;AAAA,MAAA;AAGM,cAAA;AAAA,QACN,MAAM,IAAI,UAAU,YAAY,MAAM,oBAAI,KAAK,GAAE,YAAa,CAAA,MAAM,EAAE,EAAE;AAAA,QACxE,GAAG;AAAA,MACL;AAAA,IACF;AAAA,IAEA,QAAQ,MAAc;AACpB,UAAI,QAAQ;AACH,eAAA;AAAA,MAAA;AAGT,aAAO,IAAI,IAAI;AAAA,IACjB;AAAA,IAEA,YAAY,WAAmB,MAAc;AAC3C,UAAI,QAAQ;AACH,eAAA;AAAA,MAAA;AAGH,YAAA,cAAc,IAAI,YAAY,UAAU;AAAA,QAC5C,QAAQ,GAAG,OAAO,GAAG,IAAI,OAAO,EAAE,GAAG,MAAM,MAAM,OAAO,CAAC;AAAA,QACzD,iBAAiB;AAAA,QACjB,mBAAmB;AAAA,QACnB,YAAY;AAAA,QACZ,aAAa;AAAA,MAAA,CACd;AAEW,kBAAA,MAAM,WAAW,CAAC;AAEvB,aAAA;AAAA,IAAA;AAAA,EAEX;AACF;"}