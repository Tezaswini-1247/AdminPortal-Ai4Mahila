{"version":3,"file":"monorepo.mjs","sources":["../../../src/node/core/monorepo.ts"],"sourcesContent":["import path from 'path';\r\nimport readPkgUp from 'read-pkg-up';\r\n\r\ninterface StrapiMonorepo {\r\n  path: string;\r\n}\r\n\r\n/**\r\n * Load information about the strapi CMS monorepo (if applicable)\r\n *\r\n * @internal\r\n */\r\nasync function loadStrapiMonorepo(cwd: string): Promise<StrapiMonorepo | undefined> {\r\n  let p = cwd;\r\n\r\n  while (p !== '/') {\r\n    const readResult = await readPkgUp({ cwd: p });\r\n\r\n    if (!readResult) {\r\n      return undefined;\r\n    }\r\n\r\n    if (readResult.packageJson.isStrapiMonorepo) {\r\n      return { path: path.dirname(readResult.path) };\r\n    }\r\n\r\n    p = path.dirname(path.dirname(readResult.path));\r\n  }\r\n\r\n  return undefined;\r\n}\r\n\r\nexport { loadStrapiMonorepo };\r\nexport type { StrapiMonorepo };\r\n"],"names":[],"mappings":";;AAYA,eAAe,mBAAmB,KAAkD;AAClF,MAAI,IAAI;AAER,SAAO,MAAM,KAAK;AAChB,UAAM,aAAa,MAAM,UAAU,EAAE,KAAK,GAAG;AAE7C,QAAI,CAAC,YAAY;AACR,aAAA;AAAA,IAAA;AAGL,QAAA,WAAW,YAAY,kBAAkB;AAC3C,aAAO,EAAE,MAAM,KAAK,QAAQ,WAAW,IAAI,EAAE;AAAA,IAAA;AAG/C,QAAI,KAAK,QAAQ,KAAK,QAAQ,WAAW,IAAI,CAAC;AAAA,EAAA;AAGzC,SAAA;AACT;"}