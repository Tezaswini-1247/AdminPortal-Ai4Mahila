{"version":3,"file":"report.js","sources":["../../../src/cli/commands/report.ts"],"sourcesContent":["import { createCommand } from 'commander';\r\nimport { EOL } from 'os';\r\nimport { createStrapi, compileStrapi } from '@strapi/core';\r\nimport type { StrapiCommand } from '../types';\r\nimport { runAction } from '../utils/helpers';\r\n\r\ninterface CmdOptions {\r\n  uuid: boolean;\r\n  dependencies: boolean;\r\n  all: boolean;\r\n}\r\n\r\nconst action = async ({ uuid, dependencies, all }: CmdOptions) => {\r\n  const config = {\r\n    reportUUID: Boolean(all || uuid),\r\n    reportDependencies: Boolean(all || dependencies),\r\n  };\r\n\r\n  const appContext = await compileStrapi();\r\n  const app = await createStrapi(appContext).register();\r\n\r\n  let debugInfo = `Launched In: ${Date.now() - app.config.launchedAt} ms\r\nEnvironment: ${app.config.environment}\r\nOS: ${process.platform}-${process.arch}\r\nStrapi Version: ${app.config.info.strapi}\r\nNode/Yarn Version: ${process.env.npm_config_user_agent}\r\nEdition: ${app.EE ? 'Enterprise' : 'Community'}\r\nDatabase: ${app?.config?.database?.connection?.client ?? 'unknown'}`;\r\n\r\n  if (config.reportUUID) {\r\n    debugInfo += `${EOL}UUID: ${app.config.uuid}`;\r\n  }\r\n\r\n  if (config.reportDependencies) {\r\n    debugInfo += `${EOL}Dependencies: ${JSON.stringify(app.config.info.dependencies, null, 2)}\r\nDev Dependencies: ${JSON.stringify(app.config.info.devDependencies, null, 2)}`;\r\n  }\r\n\r\n  console.log(debugInfo);\r\n\r\n  await app.destroy();\r\n};\r\n\r\n/**\r\n * `$ strapi report`\r\n */\r\nconst command: StrapiCommand = () => {\r\n  return createCommand('report')\r\n    .description('Get system stats for debugging and submitting issues')\r\n    .option('-u, --uuid', 'Include Project UUID')\r\n    .option('-d, --dependencies', 'Include Project Dependencies')\r\n    .option('--all', 'Include All Information')\r\n    .action(runAction('report', action));\r\n};\r\n\r\nexport { command };\r\n"],"names":["compileStrapi","createStrapi","EOL","createCommand","runAction"],"mappings":";;;;;;AAYA,MAAM,SAAS,OAAO,EAAE,MAAM,cAAc,UAAsB;AAChE,QAAM,SAAS;AAAA,IACb,YAAY,QAAQ,OAAO,IAAI;AAAA,IAC/B,oBAAoB,QAAQ,OAAO,YAAY;AAAA,EACjD;AAEM,QAAA,aAAa,MAAMA,mBAAc;AACvC,QAAM,MAAM,MAAMC,KAAAA,aAAa,UAAU,EAAE,SAAS;AAEpD,MAAI,YAAY,gBAAgB,KAAK,QAAQ,IAAI,OAAO,UAAU;AAAA,eACrD,IAAI,OAAO,WAAW;AAAA,MAC/B,QAAQ,QAAQ,IAAI,QAAQ,IAAI;AAAA,kBACpB,IAAI,OAAO,KAAK,MAAM;AAAA,qBACnB,QAAQ,IAAI,qBAAqB;AAAA,WAC3C,IAAI,KAAK,eAAe,WAAW;AAAA,YAClC,KAAK,QAAQ,UAAU,YAAY,UAAU,SAAS;AAEhE,MAAI,OAAO,YAAY;AACrB,iBAAa,GAAGC,MAAG,SAAS,IAAI,OAAO,IAAI;AAAA,EAAA;AAG7C,MAAI,OAAO,oBAAoB;AAChB,iBAAA,GAAGA,MAAG,iBAAiB,KAAK,UAAU,IAAI,OAAO,KAAK,cAAc,MAAM,CAAC,CAAC;AAAA,oBACzE,KAAK,UAAU,IAAI,OAAO,KAAK,iBAAiB,MAAM,CAAC,CAAC;AAAA,EAAA;AAG1E,UAAQ,IAAI,SAAS;AAErB,QAAM,IAAI,QAAQ;AACpB;AAKA,MAAM,UAAyB,MAAM;AAC5B,SAAAC,UAAA,cAAc,QAAQ,EAC1B,YAAY,sDAAsD,EAClE,OAAO,cAAc,sBAAsB,EAC3C,OAAO,sBAAsB,8BAA8B,EAC3D,OAAO,SAAS,yBAAyB,EACzC,OAAOC,QAAA,UAAU,UAAU,MAAM,CAAC;AACvC;;"}