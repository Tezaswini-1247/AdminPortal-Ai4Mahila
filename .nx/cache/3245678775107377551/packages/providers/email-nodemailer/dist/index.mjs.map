{"version":3,"file":"index.mjs","sources":["../src/index.ts"],"sourcesContent":["import _ from 'lodash';\r\nimport nodemailer, { SendMailOptions } from 'nodemailer';\r\n\r\ninterface Settings {\r\n  defaultFrom: string;\r\n  defaultReplyTo: string;\r\n}\r\n\r\ninterface SendOptions {\r\n  from?: string;\r\n  to: string;\r\n  cc: string;\r\n  bcc: string;\r\n  replyTo?: string;\r\n  subject: string;\r\n  text: string;\r\n  html: string;\r\n  [key: string]: unknown;\r\n}\r\n\r\ntype ProviderOptions = Parameters<typeof nodemailer.createTransport>[0];\r\n\r\nconst emailFields = [\r\n  'from',\r\n  'replyTo',\r\n  'to',\r\n  'cc',\r\n  'bcc',\r\n  'subject',\r\n  'text',\r\n  'html',\r\n  'attachments',\r\n];\r\n\r\nexport default {\r\n  provider: 'nodemailer',\r\n  name: 'Nodemailer',\r\n\r\n  init(providerOptions: ProviderOptions, settings: Settings) {\r\n    const transporter = nodemailer.createTransport(providerOptions);\r\n\r\n    return {\r\n      send(options: SendOptions) {\r\n        // Default values.\r\n        const emailOptions: SendMailOptions = {\r\n          ..._.pick(options, emailFields),\r\n          from: options.from || settings.defaultFrom,\r\n          replyTo: options.replyTo || settings.defaultReplyTo,\r\n          text: options.text || options.html,\r\n          html: options.html || options.text,\r\n        };\r\n\r\n        return transporter.sendMail(emailOptions);\r\n      },\r\n    };\r\n  },\r\n};\r\n"],"names":[],"mappings":";;AAsBA,MAAM,cAAc;AAAA,EAClB;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;AAEA,MAAe,QAAA;AAAA,EACb,UAAU;AAAA,EACV,MAAM;AAAA,EAEN,KAAK,iBAAkC,UAAoB;AACnD,UAAA,cAAc,WAAW,gBAAgB,eAAe;AAEvD,WAAA;AAAA,MACL,KAAK,SAAsB;AAEzB,cAAM,eAAgC;AAAA,UACpC,GAAG,EAAE,KAAK,SAAS,WAAW;AAAA,UAC9B,MAAM,QAAQ,QAAQ,SAAS;AAAA,UAC/B,SAAS,QAAQ,WAAW,SAAS;AAAA,UACrC,MAAM,QAAQ,QAAQ,QAAQ;AAAA,UAC9B,MAAM,QAAQ,QAAQ,QAAQ;AAAA,QAChC;AAEO,eAAA,YAAY,SAAS,YAAY;AAAA,MAAA;AAAA,IAE5C;AAAA,EAAA;AAEJ;"}