{"version":3,"file":"webhooks.js","sources":["../../src/providers/webhooks.ts"],"sourcesContent":["import { defineProvider } from './provider';\r\nimport { createWebhookStore, webhookModel } from '../services/webhook-store';\r\nimport createWebhookRunner from '../services/webhook-runner';\r\n\r\nexport default defineProvider({\r\n  init(strapi) {\r\n    strapi.get('models').add(webhookModel);\r\n\r\n    strapi.add('webhookStore', () => createWebhookStore({ db: strapi.db }));\r\n    strapi.add('webhookRunner', () =>\r\n      createWebhookRunner({\r\n        eventHub: strapi.eventHub,\r\n        logger: strapi.log,\r\n        configuration: strapi.config.get('server.webhooks', {}),\r\n        fetch: strapi.fetch,\r\n      })\r\n    );\r\n  },\r\n  async bootstrap(strapi) {\r\n    const webhooks = await strapi.get('webhookStore').findWebhooks();\r\n    if (!webhooks) {\r\n      return;\r\n    }\r\n\r\n    for (const webhook of webhooks) {\r\n      strapi.get('webhookRunner').add(webhook);\r\n    }\r\n  },\r\n});\r\n"],"names":["defineProvider","webhookModel","createWebhookStore","createWebhookRunner","webhooks"],"mappings":";;;;AAIA,MAAA,WAAeA,wBAAe;AAAA,EAC5B,KAAK,QAAQ;AACX,WAAO,IAAI,QAAQ,EAAE,IAAIC,aAAAA,YAAY;AAE9B,WAAA,IAAI,gBAAgB,MAAMC,aAAAA,mBAAmB,EAAE,IAAI,OAAO,GAAG,CAAC,CAAC;AAC/D,WAAA;AAAA,MAAI;AAAA,MAAiB,MAC1BC,cAAoB;AAAA,QAClB,UAAU,OAAO;AAAA,QACjB,QAAQ,OAAO;AAAA,QACf,eAAe,OAAO,OAAO,IAAI,mBAAmB,CAAA,CAAE;AAAA,QACtD,OAAO,OAAO;AAAA,MACf,CAAA;AAAA,IACH;AAAA,EACF;AAAA,EACA,MAAM,UAAU,QAAQ;AACtB,UAAMC,YAAW,MAAM,OAAO,IAAI,cAAc,EAAE,aAAa;AAC/D,QAAI,CAACA,WAAU;AACb;AAAA,IAAA;AAGF,eAAW,WAAWA,WAAU;AAC9B,aAAO,IAAI,eAAe,EAAE,IAAI,OAAO;AAAA,IAAA;AAAA,EACzC;AAEJ,CAAC;;"}