{"version":3,"file":"errors.js","sources":["../../src/services/errors.ts"],"sourcesContent":["import createError from 'http-errors';\r\nimport { errors } from '@strapi/utils';\r\n\r\nconst mapErrorsAndStatus = [\r\n  {\r\n    classError: errors.UnauthorizedError,\r\n    status: 401,\r\n  },\r\n  {\r\n    classError: errors.ForbiddenError,\r\n    status: 403,\r\n  },\r\n  {\r\n    classError: errors.NotFoundError,\r\n    status: 404,\r\n  },\r\n  {\r\n    classError: errors.PayloadTooLargeError,\r\n    status: 413,\r\n  },\r\n  {\r\n    classError: errors.RateLimitError,\r\n    status: 429,\r\n  },\r\n  {\r\n    classError: errors.NotImplementedError,\r\n    status: 501,\r\n  },\r\n];\r\n\r\nconst formatApplicationError = (error: InstanceType<typeof errors.ApplicationError>) => {\r\n  const errorAndStatus = mapErrorsAndStatus.find((pair) => error instanceof pair.classError);\r\n  const status = errorAndStatus ? errorAndStatus.status : 400;\r\n\r\n  return {\r\n    status,\r\n    body: {\r\n      data: null,\r\n      error: {\r\n        status,\r\n        name: error.name,\r\n        message: error.message,\r\n        details: error.details,\r\n      },\r\n    },\r\n  };\r\n};\r\n\r\nconst formatHttpError = (error: createError.HttpError) => {\r\n  return {\r\n    status: error.status,\r\n    body: {\r\n      data: null,\r\n      error: {\r\n        status: error.status,\r\n        name: error.name,\r\n        message: error.message,\r\n        details: error.details,\r\n      },\r\n    },\r\n  };\r\n};\r\n\r\nconst formatInternalError = (error: unknown) => {\r\n  if (!(error instanceof Error)) {\r\n    return formatHttpError(createError(500));\r\n  }\r\n\r\n  const httpError = createError(error);\r\n\r\n  if (httpError.expose) {\r\n    return formatHttpError(httpError);\r\n  }\r\n\r\n  return formatHttpError(createError(httpError.status || 500));\r\n};\r\n\r\nexport { formatApplicationError, formatHttpError, formatInternalError };\r\n"],"names":["errors","createError"],"mappings":";;;;;;AAGA,MAAM,qBAAqB;AAAA,EACzB;AAAA,IACE,YAAYA,YAAO,OAAA;AAAA,IACnB,QAAQ;AAAA,EACV;AAAA,EACA;AAAA,IACE,YAAYA,YAAO,OAAA;AAAA,IACnB,QAAQ;AAAA,EACV;AAAA,EACA;AAAA,IACE,YAAYA,YAAO,OAAA;AAAA,IACnB,QAAQ;AAAA,EACV;AAAA,EACA;AAAA,IACE,YAAYA,YAAO,OAAA;AAAA,IACnB,QAAQ;AAAA,EACV;AAAA,EACA;AAAA,IACE,YAAYA,YAAO,OAAA;AAAA,IACnB,QAAQ;AAAA,EACV;AAAA,EACA;AAAA,IACE,YAAYA,YAAO,OAAA;AAAA,IACnB,QAAQ;AAAA,EAAA;AAEZ;AAEM,MAAA,yBAAyB,CAAC,UAAwD;AACtF,QAAM,iBAAiB,mBAAmB,KAAK,CAAC,SAAS,iBAAiB,KAAK,UAAU;AACnF,QAAA,SAAS,iBAAiB,eAAe,SAAS;AAEjD,SAAA;AAAA,IACL;AAAA,IACA,MAAM;AAAA,MACJ,MAAM;AAAA,MACN,OAAO;AAAA,QACL;AAAA,QACA,MAAM,MAAM;AAAA,QACZ,SAAS,MAAM;AAAA,QACf,SAAS,MAAM;AAAA,MAAA;AAAA,IACjB;AAAA,EAEJ;AACF;AAEM,MAAA,kBAAkB,CAAC,UAAiC;AACjD,SAAA;AAAA,IACL,QAAQ,MAAM;AAAA,IACd,MAAM;AAAA,MACJ,MAAM;AAAA,MACN,OAAO;AAAA,QACL,QAAQ,MAAM;AAAA,QACd,MAAM,MAAM;AAAA,QACZ,SAAS,MAAM;AAAA,QACf,SAAS,MAAM;AAAA,MAAA;AAAA,IACjB;AAAA,EAEJ;AACF;AAEM,MAAA,sBAAsB,CAAC,UAAmB;AAC1C,MAAA,EAAE,iBAAiB,QAAQ;AACtB,WAAA,gBAAgBC,6BAAY,GAAG,CAAC;AAAA,EAAA;AAGnC,QAAA,YAAYA,6BAAY,KAAK;AAEnC,MAAI,UAAU,QAAQ;AACpB,WAAO,gBAAgB,SAAS;AAAA,EAAA;AAGlC,SAAO,gBAAgBA,qBAAA,QAAY,UAAU,UAAU,GAAG,CAAC;AAC7D;;;;"}